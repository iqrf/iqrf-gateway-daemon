{"driver": "//############################################################################################\r\n\r\n/* Title: Embedded DPA exploration driver\r\nSee also: <https://www.iqrf.org/DpaTechGuide/>\r\n*/\r\n\r\n/*DriverDescription\r\n{ 'ID' : 0xFF,\r\n  'Type' : 'Standard',\r\n  'Internal' : false,\r\n  'Versions' : [\r\n    { 'Version' : 0, 'Notes' : [\r\n        '1st line',\r\n        '2nd line' ]\r\n    }\r\n  ] }\r\nDriverDescription*/\r\n\r\n\"use strict\";\r\n// Namespace: iqrf.embed.explore\r\nnamespace( 'iqrf.embed.explore' );\r\n\r\n/* Function: iqrf.embed.explore.Enumerate_Request\r\nEncodes DPA request to enumerate DPA peripherals.\r\n\r\nReturns:\r\n  iqrf.DpaRawHdpMessage: DPA request object.\r\n*/\r\niqrf.embed.explore.Enumerate_Request = function ()\r\n{\r\n  return new iqrf.DpaRawHdpMessage( iqrf.PNUM_Enumeration, '3f' );\r\n};\r\n\r\n/* Function: iqrf.embed.explore.Enumerate_Response\r\nDecodes DPA response from enumerating DPA peripherals.\r\n\r\nParameters:\r\n  response - iqrf.DpaRawHdpMessage: DPA response object.\r\n\r\nReturns:\r\n  object: Object with the following fields (see DPA documentation https://www.iqrf.org/DpaTechGuide/ for details):\r\n\r\n* dpaVer - number:\r\n* perNr - number:\r\n* embeddedPers - number:\r\n* hwpid - number:\r\n* hwpidVer - number:\r\n* flags - number:\r\n* userPer - array:\r\n*/\r\niqrf.embed.explore.Enumerate_Response = function ( response )\r\n{\r\n  var responseData = iqrf.CheckResponsePnumPcmdDlen( response, iqrf.PNUM_Enumeration, 'bf', -12 );\r\n  var result =\r\n    {\r\n      dpaVer: responseData[0] + ( responseData[1] * 0x100 ),\r\n      perNr: responseData[2],\r\n      embeddedPers: iqrf.BitmapToIndexes( responseData, 3, 6 ),\r\n      hwpid: responseData[7] + ( responseData[8] * 0x100 ),\r\n      hwpidVer: responseData[9] + ( responseData[10] * 0x100 ),\r\n      flags: responseData[11],\r\n      userPer: iqrf.BitmapToIndexes( responseData, 12, responseData.length - 1, 0x20 )\r\n    };\r\n\r\n  return result;\r\n};\r\n\r\n/* Function: iqrf.embed.explore.PeripheralInformation_Request\r\nEncodes DPA request to get information about a peripheral.\r\n\r\nParameters:\r\n  per - number: Peripheral to get information about.\r\n\r\nReturns:\r\n  iqrf.DpaRawHdpMessage: DPA request object.\r\n*/\r\niqrf.embed.explore.PeripheralInformation_Request = function ( per )\r\n{\r\n  return new iqrf.DpaRawHdpMessage( iqrf.ToHexStringByte( per ), '3f' );\r\n};\r\n\r\n/* Function: iqrf.embed.explore.PeripheralInformation_Response\r\nDecodes DPA response from getting information about a peripheral.\r\n\r\nParameters:\r\n  per - number: Peripheral the information is about.\r\n  response - iqrf.DpaRawHdpMessage: DPA response object.\r\n\r\nReturns:\r\n  object: Object with the following fields (see DPA documentation https://www.iqrf.org/DpaTechGuide/ for details):\r\n\r\n* perTe - number:\r\n* perT - number:\r\n* par1 - number:\r\n* par2 - number:\r\n*/\r\niqrf.embed.explore.PeripheralInformation_Response = function ( per, response )\r\n{\r\n  var responseData = iqrf.CheckResponsePnumPcmdDlen( response, iqrf.ToHexStringByte( per ), 'bf', 4 );\r\n  var result =\r\n    {\r\n      perTe: responseData[0],\r\n      perT: responseData[1],\r\n      par1: responseData[2],\r\n      par2: responseData[3]\r\n    };\r\n\r\n  return result;\r\n};\r\n\r\n/* Function: iqrf.embed.explore.MorePeripheralsInformation_Request\r\nEncodes DPA request to get information about more peripherals.\r\n\r\nParameters:\r\n  per - number: 1st peripheral to get information about.\r\n\r\nReturns:\r\n  iqrf.DpaRawHdpMessage: DPA request object.\r\n*/\r\niqrf.embed.explore.MorePeripheralsInformation_Request = function ( per )\r\n{\r\n  return new iqrf.DpaRawHdpMessage( 'ff', iqrf.ToHexStringByte( per ) );\r\n};\r\n\r\n/* Function: iqrf.embed.explore.MorePeripheralsInformation_Response\r\nDecodes DPA response from getting information about more peripherals.\r\n\r\nParameters:\r\n  per - number: 1st peripheral the information is about.\r\n  response - iqrf.DpaRawHdpMessage: DPA response object.\r\n\r\nReturns:\r\n  array: Array of objects with the following fields (see DPA documentation https://www.iqrf.org/DpaTechGuide/ for details):\r\n\r\n* perTe - number:\r\n* perT - number:\r\n* par1 - number: \r\n* par2 - number: \r\n*/\r\niqrf.embed.explore.MorePeripheralsInformation_Response = function ( per, response )\r\n{\r\n  var responseData = iqrf.CheckResponsePnumPcmdDlen( response, 'ff', iqrf.ToHexStringByte( parseInt( per, 16 ) | 0x80 ) );\r\n\r\n  var result = [];\r\n  var responseData_length = responseData.length;\r\n  for ( var index = 0; index < responseData_length; index += 4 )\r\n    result[result.length] =\r\n      {\r\n        perTe: responseData[index + 0],\r\n        perT: responseData[index + 1],\r\n        par1: responseData[index + 2],\r\n        par2: responseData[index + 3]\r\n      };\r\n\r\n  return result;\r\n};\r\n\r\n//############################################################################################\r\n", "name": "Embed: DPA Exploration", "notes": "1st line\n2nd line", "standardID": 255, "version": 0.0, "versionFlags": 0}