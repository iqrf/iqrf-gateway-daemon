{
  "$schema": "https://json-schema.org/draft-07/schema",
  "title": "IQMESH Network - AutoNetwork request",
  "description": "(c) IQRF Tech",
  "type": "object",
  "required": [
    "mType",
    "data"
  ],
  "additionalProperties": false,
  "properties": {
    "mType": {
      "allOf": [
        { "$ref": "definitions.json#/message/type" },
        { "const": "iqmeshNetwork_AutoNetwork" }
      ]
    },
    "data": {
      "title": "Message data",
      "description": "Contains the message payload.",
      "type": "object",
      "required": [
        "msgId",
        "req"
      ],
      "additionalProperties": false,
      "properties": {
        "msgId": {
          "$ref": "definitions.json#/message/id"
        },
        "req": {
          "title": "Request",
          "description": "Contains request specific parameters.",
          "type": "object",
          "required": [
            "stopConditions"
          ],
          "additionalProperties": false,
          "properties": {
            "actionRetries": {
              "description": "Number of retries DPA transactions.",
              "type": "integer",
              "minimum": 1,
              "maximum": 10,
              "default": 1
            },
            "addressSpace": {
              "title": "Address space",
              "description": "List of addresses which can be assigned during Autonetwork.",
              "type": "array",
              "items": {
                "$ref": "definitions.json#/node/address"
              },
              "maxItems": 239
            },
            "discoveryBeforeStart": {
              "description": "Run discovery before start.",
              "type": "boolean",
              "default": false
            },
            "discoveryTxPower": {
              "description": "TX power to use in discovery process.",
              "type": "integer",
              "minimum": 0,
              "maximum": 7,
              "default": 7
            },
            "hwpidFiltering": {
              "description": "Allows to add only nodes with specified HWPID to the network.",
              "type": "array",
              "items": {
                "$ref": "definitions.json#/request/hwpId"
              }
            },
            "midFiltering": {
              "description": "Bond only Nodes with MIDs listed in the midList array.",
              "type": "boolean",
              "default": false
            },
            "midList": {
              "description": "Select this option to control MIDs of the Nodes and/or their addresses.",
              "type": "array",
              "items": {
                "title": "Device bonding information",
                "type": "object",
                "required": [
                  "deviceMID"
                ],
                "additionalProperties": false,
                "properties": {
                  "deviceAddr": {
                    "$ref": "definitions.json#/node/address"
                  },
                  "deviceMID": {
                    "$ref": "definitions.json#/transceiver/idStr"
                  }
                }
              },
              "maxItems": 239
            },
            "overlappingNetworks": {
              "title": "Overlap settings",
              "description": "Settings for building multiple overlapping networks.",
              "type": "object",
              "required": [
                "network",
                "networks"
              ],
              "additionalProperties": false,
              "properties": {
                "network": {
                  "description": "The network number of the current network.",
                  "type": "integer"
                },
                "networks": {
                  "description": "How many networks shall be built.",
                  "type": "integer"
                }
              }
            },
            "skipDiscoveryEachWave": {
              "description": "Skip discovery in each wave.",
              "type": "boolean",
              "default": false
            },
            "skipPrebonding": {
              "description": "Skip SmartConnect.",
              "type": "boolean",
              "default": false
            },
            "stopConditions": {
              "title": "Stop conditions",
              "description": "Autonetwork will iteratively look for other devices until one of the stop conditions is met.",
              "type": "object",
              "required": [
                "emptyWaves"
              ],
              "properties": {
                "emptyWaves": {
                  "description": "Number of consecutive waves, in which no new nodes were added into network.",
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 255,
                  "default": 2
                },
                "abortOnTooManyNodesFound": {
                  "description": "Abort the Autonetwork if too many nodes were found.",
                  "type": "boolean",
                  "default": false
                },
                "numberOfNewNodes": {
                  "description": "Number of new nodes bonded into the network.",
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 239
                },
                "numberOfTotalNodes": {
                  "description": "Number of total nodes bonded into the network.",
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 239
                },
                "waves": {
                  "description": "Maximum number of waves.",
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 255
                }
              }
            },
            "unbondUnrespondingNodes": {
              "default": true,
              "description": "Unbond Nodes that don't respond.",
              "type": "boolean"
            }
          }
        },
        "repeat": {
          "$ref": "definitions.json#/iqmesh/repeat"
        },
        "returnVerbose": {
          "$ref": "definitions.json#/request/returnVerbose"
        }
      }
    }
  }
}
