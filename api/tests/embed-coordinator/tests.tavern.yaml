# test_mqtt.tavern.yaml
---

test_name: Test mqtt message - embed coordinator bonded devices

paho-mqtt: &mqtt_spec
  client:
    transport: tcp
    client_id: tavern-tester
  connect:
    host: 10.0.1.29
    port: 1883
    timeout: 5

stages:
  - name: bonded devices
    mqtt_publish:
      topic: Iqrf/DpaRequest
      json: !include iqrfEmbedCoordinator_BondedDevices-request-1-0-0.yaml

    mqtt_response:
      topic: Iqrf/DpaResponse
      json: !include iqrfEmbedCoordinator_BondedDevices-response-1-0-0.yaml
      timeout: 1

---

test_name: Test mqtt message - embed coordinator discovered devices
paho-mqtt: *mqtt_spec
stages:

  - name: discovered devices
    mqtt_publish:
      topic: Iqrf/DpaRequest
      json: !include iqrfEmbedCoordinator_DiscoveredDevices-request-1-0-0.yaml

    mqtt_response:
      topic: Iqrf/DpaResponse
      json: !include iqrfEmbedCoordinator_DiscoveredDevices-response-1-0-0.yaml
      timeout: 1
