# tests_leds.tavern.yaml
---

test_name: Test mqtt message - embed coordinator bonded devices

includes:
  - !include common.yaml

paho-mqtt: &mqtt_spec
  client:
    transport: tcp
    client_id: tavern-tester
  connect:
    host: "{mqtt_host:s}"
    port: !int "{mqtt_port:d}"
    timeout: 5

stages:
  - name: ledg pulse
    mqtt_publish:
      topic: Iqrf/DpaRequest
      json: !include messages/iqrfEmbedLedg_Pulse-request-1-0-0.yaml

    mqtt_response:
      topic: Iqrf/DpaResponse
      json: !include messages/iqrfEmbedLedg_Pulse-response-1-0-0.yaml
      timeout: 1

  - name: ledr pulse
    mqtt_publish:
      topic: Iqrf/DpaRequest
      json: !include messages/iqrfEmbedLedr_Pulse-request-1-0-0.yaml

    mqtt_response:
      topic: Iqrf/DpaResponse
      json: !include messages/iqrfEmbedLedr_Pulse-response-1-0-0.yaml
      timeout: 1
